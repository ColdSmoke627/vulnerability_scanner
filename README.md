# vulnerability_scanner

**Work in progress...**

## What it does:

Searches for vulnerabilities (CVEs) by estimated CPEs for the installed packages and stores everything inside a sqlite database.
Currently just supported for dpkg based operating systems.

## Todo list:

- Support for other package management systems (apt, rpm, zypper, gem)
- Improvement of usability and design (script usage and output)
- Web application for graphical reports, lists and management of vulnerabilities
- Improvement of identifying CPEs and their CVEs
- Secure API interface to get assets and vulnerabilities (json, xml, csv)
- Connect more sources with vulnerability information
- Maybe support for Windows and MacOS (wmic, powershell, homebrew)

## Installation:

```bash
apt install python2.7
apt install python-pip
git clone https://github.com/tinoloni/vulnerability_scanner.git
cd vulnerability_scanner
pip install -r requirements.txt
```	
## Usage:

The script is splitted into three parts:

1. software_cpes (-s option)
2. nvd_update (-n option)
3. vuln_scan (-v option)

By default without using any of these options everything gets executed.

![alt text](https://github.com/tinoloni/vulnerability_scanner/blob/master/screenshots/vulnerability_scanner.png)

After scanning you can start webapp (http://localhost:5000) showing a list of found vulnerabilities with:

```bash
python run.py
```

## Tested with:

- Ubuntu 16.04 LTS
- Debian 9.0

## Database Structure:

| Table | Attributes |
| --- | :--- |
| cves | cveid (PK)<br>cvss<br>access_vector<br>access_complexity<br>authentication<br>confidentiality_impact<br>integrity_impact<br>availability_impact<br>description<br>published<br>modified<br>link|
| cpes | id (PK)<br>string<br>os<br>vendor<br>product<br>version<br>update_date<br>edition<br>language |
| cpe_cve | id (PK)<br>cpe (FK)<br>cveid (FK) |
| download_dates | link (PK)<br>last_download |
| software | id (PK)<br>string<br>package<br>vendor<br>product<br>version<br>cpe_found<br>maybe_wrong_vendor |
| scanresult | id (PK)<br>software_id (FK)<br> cve_id (FK) |
